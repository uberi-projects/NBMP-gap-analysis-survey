<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UB-ERI Biodiversity Monitoring Gap Analysis Survey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #f0fdf4 0%, #dbeafe 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            padding: 40px;
        }

        h1 {
            color: #166534;
            font-size: 28px;
            margin-bottom: 10px;
        }

        h2 {
            color: #166534;
            font-size: 24px;
            margin-bottom: 20px;
        }

        .header-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-info {
            font-size: 14px;
            color: #6b7280;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e5e7eb;
            border-radius: 999px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #16a34a;
            transition: width 0.3s ease;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 500;
            color: #374151;
            margin-bottom: 10px;
            font-size: 14px;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #16a34a;
            box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.1);
        }

        textarea {
            resize: vertical;
        }

        .radio-group,
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option,
        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        input[type="radio"],
        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .checkbox-scroll {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
        }

        .nested-group {
            margin-left: 26px;
            margin-top: 8px;
            padding-left: 10px;
            border-left: 2px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .nested-group[hidden] {
            display: none;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            font-size: 13px;
        }

        table,
        th,
        td {
            border: 1px solid #d1d5db;
        }

        th {
            background: #f9fafb;
            padding: 10px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 8px;
        }

        td input {
            width: 100%;
            padding: 6px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 13px;
        }

        .add-row-btn {
            background: #16a34a;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
        }

        .add-row-btn:hover {
            background: #15803d;
        }

        .remove-btn {
            color: #dc2626;
            cursor: pointer;
            font-size: 12px;
            text-decoration: underline;
        }

        .remove-btn:hover {
            color: #991b1b;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn.prev {
            background: #4b5563;
            color: white;
        }

        .nav-btn.prev:hover:not(:disabled) {
            background: #374151;
        }

        .nav-btn.next {
            background: #16a34a;
            color: white;
        }

        .nav-btn.next:hover:not(:disabled) {
            background: #15803d;
        }

        .nav-btn:disabled {
            background: #d1d5db;
            color: #9ca3af;
            cursor: not-allowed;
        }

        .intro-box {
            background: #f0fdf4;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .intro-box p {
            color: #374151;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .intro-box ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .intro-box li {
            color: #374151;
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 13px;
            color: #6b7280;
        }

        .footer p {
            margin-top: 5px;
        }

        .conditional {
            margin-left: 20px;
            margin-top: 15px;
        }

        .thank-you-box {
            display: none;
            text-align: center;
            padding: 60px 40px;
        }

        .thank-you-box h2 {
            color: #166534;
            font-size: 28px;
            margin-bottom: 15px;
        }

        .thank-you-box p {
            color: #374151;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .error-msg {
            display: none;
            background: #fef2f2;
            border: 1px solid #fca5a5;
            color: #991b1b;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            margin-top: 15px;
        }

        .validation-error {
            display: none;
            color: #991b1b;
            font-size: 13px;
            margin-top: 6px;
        }

        .retry-btn {
            background: #16a34a;
            color: white;
            border: none;
            padding: 6px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-left: 10px;
            vertical-align: middle;
        }

        .retry-btn:hover {
            background: #15803d;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>UB-ERI Biodiversity Monitoring Gap Analysis</h1>

        <div class="header-info">
            <div class="section-info">
                Section <span id="currentSection">1</span> of <span id="totalSections">10</span>: <span
                    id="sectionName">Introduction</span>
            </div>
        </div>

        <form id="surveyForm">
            <!-- Section 0: Introduction -->
            <div class="section active" data-section="0">
                <h2>Welcome to the Gap Analysis Survey</h2>
                <div class="intro-box">
                    <p>This survey is being conducted as part of the Gap Analysis for the National Biodiversity
                        Monitoring Plan (NBMP) currently being developed by the University of Belize Environmental
                        Research Institute (UB-ERI).</p>
                    <p>The purpose of this survey is to:</p>
                    <ol>
                        <li>Identify the biodiversity monitoring currently taking place in Belize and the methodologies
                            being used</li>
                        <li>Determine critical gaps in existing biodiversity monitoring efforts</li>
                        <li>Highlight priority species and geographic areas of interest</li>
                    </ol>
                    <p><strong>Your participation is highly valuable.</strong> The information gathered will support
                        UB-ERI in developing a comprehensive and coordinated NBMP that addresses key monitoring gaps,
                        strengthens collaboration among stakeholders, and promotes effective biodiversity conservation
                        across Belize.</p>
                </div>
            </div>

            <!-- Section 1: Organization Info -->
            <div class="section" data-section="1">
                <h2>Organization Information</h2>
                <div class="form-group">
                    <label>Organization Name *</label>
                    <input type="text" name="organizationName" placeholder="Enter your organization name">
                    <div class="validation-error" id="validateOrgName">Please enter your organization name.</div>
                </div>
            </div>

            <!-- Section 2: Monitoring Activities -->
            <div class="section" data-section="2">
                <h2>Biodiversity Monitoring Activities</h2>
                <div class="form-group">
                    <label>1. Does your organization do long-term biodiversity monitoring projects and/or project-based
                        biodiversity research? *</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="doesMonitoring" value="Yes"
                                onchange="toggleMonitoringQuestions()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="doesMonitoring" value="No" onchange="toggleMonitoringQuestions()">
                            <span>No</span>
                        </label>
                    </div>
                    <div class="validation-error" id="validateMonitoring">Please select an option.</div>
                </div>

                <div id="monitoringAreasSection" style="display: none;">
                    <div class="form-group">
                        <label>2. Which taxa does your organization do monitoring in? (Select all that apply)</label>
                        <div class="checkbox-scroll checkbox-group">
                            <label class="checkbox-option"><input type="checkbox" name="monitoringAreas" value="Birds">
                                Birds</label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Mammals"
                                    onchange="toggleMammalsOptions()">
                                Mammals
                            </label>
                            <div id="mammalsOptions" class="nested-group" hidden>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Mammals - Bats"> Bats</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Mammals - Marine mammals"> Marine mammals</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Mammals - Primates"> Primates</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Mammals - Other large mammals (e.g., jaguars)"> Other large mammals
                                    (e.g., jaguars)</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Mammals - Other medium-sized mammals (e.g., paca)"> Other medium-sized
                                    mammals (e.g., paca)</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Mammals - Other small mammals (e.g., hispid cotton rat)"> Other small
                                    mammals (e.g., hispid cotton rat)</label>
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Fish"
                                    onchange="toggleFishOptions()">
                                Fish
                            </label>
                            <div id="fishOptions" class="nested-group" hidden>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Fish - Freshwater fish"> Freshwater fish</label>
                                <label class="checkbox-option">
                                    <input type="checkbox" name="monitoringAreas" value="Fish - Marine fish"
                                        onchange="toggleMarineFishOptions()">
                                    Marine fish
                                </label>
                                <div id="marineFishOptions" class="nested-group" hidden>
                                    <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                            value="Fish - Marine fish - Sharks"> Sharks</label>
                                    <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                            value="Fish - Marine fish - Commercial fish"> Commercial fish</label>
                                    <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                            value="Fish - Marine fish - Reef fish"> Reef fish</label>
                                    <input type="text" name="marineFishOther" placeholder="Other (please specify)"
                                        style="margin-top: 5px;">
                                </div>
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Marine Invertebrates"
                                    onchange="toggleMarineInvertebratesOptions()">
                                Marine Invertebrates (e.g., Coral)
                            </label>
                            <div id="marineInvertebratesOptions" class="nested-group" hidden>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Conch"> Conch</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Crustaceans"> Crustaceans</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Mollusks"> Mollusks</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Crabs"> Crabs</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Lobsters"> Lobsters</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Corals"> Corals</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Urchins"> Urchins</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Marine Invertebrates - Sea Cucumbers"> Sea Cucumbers</label>
                                <input type="text" name="marineInvertebratesOther" placeholder="Other (please specify)"
                                    style="margin-top: 5px;">
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Freshwater Macroinvertebrate"
                                    onchange="toggleFreshwaterMacroOptions()">
                                Freshwater Macroinvertebrate
                            </label>
                            <div id="freshwaterMacroOptions" class="nested-group" hidden>
                                <input type="text" name="freshwaterMacroSpecify" placeholder="Specify">
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Terrestrial Macroinvertebrates"
                                    onchange="toggleTerrestrialInvertebratesOptions()">
                                Terrestrial Macroinvertebrates (e.g., Insects)
                            </label>
                            <div id="terrestrialInvertebratesOptions" class="nested-group" hidden>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Terrestrial Macroinvertebrates - Agricultural Pest Insects">
                                    Agricultural Pest Insects (e.g., stem-borers)</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Terrestrial Macroinvertebrates - Disease Vector Insects">
                                    Disease Vector Insects (e.g., mosquitoes, screwworms)</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Terrestrial Macroinvertebrates - Butterflies"> Butterflies</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Terrestrial Macroinvertebrates - Bees"> Bees</label>
                                <input type="text" name="terrestrialInvertebratesOther"
                                    placeholder="Other (please specify)" style="margin-top: 5px;">
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Amphibians"
                                    onchange="toggleAmphibiansOptions()">
                                Amphibians
                            </label>
                            <div id="amphibiansOptions" class="nested-group" hidden>
                                <input type="text" name="amphibiansSpecify" placeholder="Specify (please specify)">
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Reptiles"
                                    onchange="toggleReptilesOptions()">
                                Reptiles
                            </label>
                            <div id="reptilesOptions" class="nested-group" hidden>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Reptiles - Snakes"> Snakes</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Reptiles - Crocodiles"> Crocodiles</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Turtles"> Turtles</label>
                                <input type="text" name="reptilesOther" placeholder="Other (please specify)"
                                    style="margin-top: 5px;">
                            </div>
                            <label class="checkbox-option">
                                <input type="checkbox" name="monitoringAreas" value="Plants"
                                    onchange="togglePlantsOptions()">
                                Plants
                            </label>
                            <div id="plantsOptions" class="nested-group" hidden>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Plants - Mangroves"> Mangroves</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Plants - Seaweed/Seagrass/Macroalgae">
                                    Seaweed/Seagrass/Macroalgae</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Plants - Hardwood Trees"> Hardwood Trees</label>
                                <label class="checkbox-option"><input type="checkbox" name="monitoringAreas"
                                        value="Plants - Epiphytes"> Epiphytes</label>
                                <input type="text" name="plantsOther" placeholder="Other (please specify)"
                                    style="margin-top: 5px;">
                            </div>
                            <div style="margin-top: 10px;">
                                <input type="text" name="monitoringAreasOther" placeholder="Other">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 3: Ecosystems -->
            <div class="section" data-section="3">
                <h2>Ecosystems</h2>

                <div class="form-group">
                    <label>3. Which ecosystems does your organization do monitoring in? (Select all that apply)</label>
                    <div class="checkbox-scroll checkbox-group">
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Savannah">
                            Savannah</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Pine Forest">
                            Pine Forest</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems"
                                value="Broad-leaved Forest"> Broad-leaved Forest</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Shrubland">
                            Shrubland</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Wetland">
                            Wetland</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Riparian">
                            Riparian</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems"
                                value="Agricultural Areas"> Agricultural Areas</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Urban">
                            Urban</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems"
                                value="Mangrove and littoral forest"> Mangrove and littoral forest</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Seagrass">
                            Seagrass</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Sparse Algae">
                            Sparse Algae</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Lagoon">
                            Lagoon</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Coral Reef">
                            Coral Reef</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Deep Reef"> Deep
                            Reef</label>
                        <label class="checkbox-option"><input type="checkbox" name="ecosystems" value="Open Sea"> Open
                            Sea</label>
                    </div>
                </div>
            </div>

            <!-- Section 4: Research Projects -->
            <div class="section" data-section="4">
                <h2>Research Projects</h2>

                <div class="form-group">
                    <label>4. What are the long-term biodiversity monitoring projects that your organization conducts or
                        used to conduct? Only list closed projects that closed no more than 10yrs ago. </label>
                    <div style="overflow-x: auto;">
                        <table id="longTermTable">
                            <thead>
                                <tr>
                                    <th>Species/Taxa</th>
                                    <th>Monitored Sites</th>
                                    <th>Year(s)</th>
                                    <th>Methods</th>
                                    <th>Still Ongoing?</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="longTermBody">
                                <tr>
                                    <td><input type="text" name="ltSpecies_0"></td>
                                    <td><input type="text" name="ltSites_0"></td>
                                    <td><input type="text" name="ltYears_0" placeholder="e.g., 2010-2022"></td>
                                    <td><input type="text" name="ltMethods_0"></td>
                                    <td><input type="text" name="ltOngoing_0" placeholder="Yes/No"></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button type="button" class="add-row-btn" onclick="addLongTermRow()">Add Row</button>
                </div>

                <div class="form-group">
                    <label>5. What are the project-based researches that have been conducted in the past 5 years?
                    </label>
                    <div style="overflow-x: auto;">
                        <table id="recentResearchTable">
                            <thead>
                                <tr>
                                    <th>Species/Taxa</th>
                                    <th>Monitored Sites</th>
                                    <th>Year(s)</th>
                                    <th>Methods</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="recentResearchBody">
                                <tr>
                                    <td><input type="text" name="rrSpecies_0"></td>
                                    <td><input type="text" name="rrSites_0"></td>
                                    <td><input type="text" name="rrYears_0" placeholder="e.g., 2019"></td>
                                    <td><input type="text" name="rrMethods_0"></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button type="button" class="add-row-btn" onclick="addRecentResearchRow()">Add Row</button>
                </div>
            </div>

            <!-- Section 5: Collaboration & Challenges -->
            <div class="section" data-section="5">
                <h2>Collaboration & Challenges</h2>

                <div class="form-group">
                    <label>6. Are these monitoring/research activities conducted in collaboration with other
                        organizations?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="collaboration" value="Yes" onchange="toggleCollaboration()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="collaboration" value="No" onchange="toggleCollaboration()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="collaborationOrgs" class="conditional" style="display: none;">
                        <label>Which organizations do you most often collaborate with?</label>
                        <textarea name="collaborationOrgsList" rows="3"
                            placeholder="List the organizations..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>7. What are the major challenges for conducting these monitoring activities? (Please provide
                        lots of detail where possible)</label>
                    <textarea name="challenges" rows="5" placeholder="Describe the challenges..."></textarea>
                </div>
            </div>

            <!-- Section 6: Technology & Skills -->
            <div class="section" data-section="6">
                <h2>Technology & Skill Gaps</h2>

                <div class="form-group">
                    <label>8. What data collection tools does your organization use? (Select all that apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option"><input type="checkbox" name="dataTools"
                                value="Printed Datasheets"> Printed Datasheets</label>
                        <label class="checkbox-option"><input type="checkbox" name="dataTools" value="SMART">
                            SMART</label>
                        <label class="checkbox-option"><input type="checkbox" name="dataTools" value="KoboToolbox">
                            KoboToolbox</label>
                        <label class="checkbox-option"><input type="checkbox" name="dataTools" value="Survey123">
                            Survey123 (ArcGIS Data Collection)</label>
                        <div style="margin-top: 10px;">
                            <input type="text" name="dataToolsOther" placeholder="Others">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>9. What technological gaps does your organization have for research and monitoring purposes?
                        (Select all that apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option"><input type="checkbox" name="techGaps" value="None"> None</label>
                        <label class="checkbox-option"><input type="checkbox" name="techGaps"
                                value="Lack of smart devices"> Lack of smart devices (e.g. phones,
                            tablets)</label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="techGaps" value="Lack of survey equipment"
                                onchange="toggleSurveyEquipmentSpecify()">
                            Lack of survey equipment (e.g. camera traps, lasers, acoustic recorders)
                        </label>
                        <div id="surveyEquipmentSpecify" class="nested-group" hidden>
                            <input type="text" name="surveyEquipmentSpecify" placeholder="Specify (please specify)">
                        </div>
                        <label class="checkbox-option"><input type="checkbox" name="techGaps"
                                value="Lack of drones for mapping"> Lack of drones for mapping</label>
                        <label class="checkbox-option"><input type="checkbox" name="techGaps"
                                value="Lack of cloud storage"> Lack of cloud storage or a secure backup
                            system</label>
                        <div style="margin-top: 10px;">
                            <input type="text" name="techGapsOther" placeholder="Others (please specify)">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>10. Do you have the complementary software to operate and process data from your
                        technological
                        survey equipment? If so, which softwares do you use?</label>
                    <textarea name="complementarySoftware" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label>11. Are you missing any other complementary software, equipment, and technology needed to
                        increase success of your long-term and project-based monitoring and research project? For
                        example, online subscriptions. If so, describe.</label>
                    <textarea name="missingSoftwareEquipment" rows="3"></textarea>
                </div>

                <div class="form-group">
                    <label>12. What technical skills and training gaps does your organization have? (Select all that
                        apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps" value="None">
                            None</label>
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps"
                                value="Limited data analysis skills"> Lack of / limited data analysis skills</label>
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps"
                                value="Limited access to GIS software"> Limited access to GIS software</label>
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps"
                                value="Limited technical support"> Limited technical support or IT personnel</label>
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps"
                                value="High staff turnover"> High staff turnover leading to repeated skill loss</label>
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps"
                                value="Difficulty with report writing"> Difficulty with report writing</label>
                        <label class="checkbox-option"><input type="checkbox" name="skillGaps"
                                value="Lack of technical skills for biodiversity projects"> Lack of technical skills for
                            developing biodiversity research and monitoring projects</label>
                        <div style="margin-top: 10px;">
                            <input type="text" name="skillGapsOther" placeholder="Others (please specify)">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>13. What type of training is staff continuously needing? (Select all that apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option"><input type="checkbox" name="trainingNeeds" value="None">
                            None</label>
                        <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                value="Technical training"> Technical training</label>
                        <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                value="Research and monitoring development"> Research and monitoring
                            development</label>
                        <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                value="Equipment operation"> Equipment operation</label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="trainingNeeds" value="Software"
                                onchange="toggleSoftwareTrainingOptions()">
                            Software
                        </label>
                        <div id="softwareTrainingOptions" class="nested-group" hidden>
                            <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                    value="Software - Data processing software"> Data processing software</label>
                            <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                    value="Software - Data analysis software"> Data analysis software</label>
                            <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                    value="Software - Geospatial software"> Geospatial software</label>
                            <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                    value="Software - Equipment operation software"> Equipment operation
                                software</label>
                        </div>
                        <label class="checkbox-option"><input type="checkbox" name="trainingNeeds"
                                value="Working with data"> Working with data</label>
                        <div style="margin-top: 10px;">
                            <input type="text" name="trainingNeedsOther" placeholder="Other (please specify)">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Section 7: Data Management -->
            <div class="section" data-section="7">
                <h2>Data Management</h2>

                <div class="form-group">
                    <label>14. When your organization digitizes its biodiversity data, describe how it does so</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" name="digitization" value="Excel/Google Sheets"
                                onchange="toggleDigitizationPortals()">
                            Excel / Google Sheets
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="digitization" value="Data portals"
                                onchange="toggleDigitizationPortals()">
                            Data portals
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="digitization" value="Never digitizes"
                                onchange="toggleDigitizationPortals()">
                            My organization never digitizes its data
                        </label>
                    </div>
                    <div id="digitizationPortalsList" class="conditional" style="display: none;">
                        <input type="text" name="digitizationPortals" placeholder="List data portals...">
                    </div>
                </div>

                <div class="form-group">
                    <label>15. Do you have any data that is currently undigitized? If so, tell us about the data and
                        whether you would like assistance in digitizing it.</label>
                    <textarea name="undigitizedData" rows="4" placeholder="Describe any undigitized data..."></textarea>
                </div>
            </div>

            <!-- Section 8: Data Sharing -->
            <div class="section" data-section="8">
                <h2>Data Sharing</h2>

                <div class="form-group">
                    <label>16. Do you submit reports on your biodiversity data to the government of Belize?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="govReports" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="govReports" value="No">
                            <span>No</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="govReports" value="We do not do reporting">
                            <span>We do not do reporting</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>17. Do you publish your technical reports online (e.g., on a website)?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="publishOnline" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="publishOnline" value="No">
                            <span>No</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="publishOnline" value="We do not do reporting">
                            <span>We do not do reporting</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>18. Do you publish peer-reviewed papers on your data?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="publishPapers" value="Yes" onchange="togglePublishPapers()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="publishPapers" value="No" onchange="togglePublishPapers()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="publishPapersFrequency" class="conditional" style="display: none;">
                        <label>How often do you publish papers?</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="publishPapersFrequency" value="1 or more times a year">
                                <span>1 or more times a year</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="publishPapersFrequency" value="1 or more times every 5 years">
                                <span>1 or more times every 5 years</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="publishPapersFrequency"
                                    value="1 or more times every 10 years">
                                <span>1 or more times every 10 years</span>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>19. Do you share biodiversity data results in a public data dashboard?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="publicDashboard" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="publicDashboard" value="No">
                            <span>No</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>20. Do you share your biodiversity datasets outside your organization?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="shareData" value="Yes" onchange="toggleShareData()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="shareData" value="No" onchange="toggleShareData()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="shareDataWho" class="conditional" style="display: none;">
                        <input type="text" name="shareDataWhom" placeholder="To who?">
                    </div>
                </div>

                <div class="form-group">
                    <label>21. Do you publish your biodiversity datasets on any online repositories?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="onlineRepos" value="Yes" onchange="toggleOnlineRepos()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="onlineRepos" value="No" onchange="toggleOnlineRepos()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="onlineReposWhich" class="conditional" style="display: none;">
                        <input type="text" name="onlineReposWhichOnes" placeholder="Which ones?">
                    </div>
                </div>

                <div class="form-group">
                    <label>22. Would you be interested in publishing your data on the GBIF online repository (gbif.org),
                        if you were given support by UB-ERI to do so to increase the visibility, traceability, and
                        impact of your work?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="gbifInterest" value="Yes">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gbifInterest" value="No">
                            <span>No</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gbifInterest" value="Maybe">
                            <span>Maybe</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Section 9: National Biodiversity Coordination -->
            <div class="section" data-section="9">
                <h2>National Biodiversity Coordination</h2>

                <div class="form-group">
                    <label>23. Is your organization involved in any national working groups related to biodiversity in
                        Belize (e.g., Sea Turtle Working Group, NCRMN, Jaguar Working Group)? If yes, list each
                        working group.</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="workingGroupsInvolved" value="Yes"
                                onchange="toggleWorkingGroups()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="workingGroupsInvolved" value="No"
                                onchange="toggleWorkingGroups()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="workingGroupsList" class="conditional" style="display: none;">
                        <textarea name="workingGroupsListText" rows="3"
                            placeholder="List each working group..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>24. Is your organization leading any of the national working groups related to biodiversity
                        in
                        Belize? If so, state which ones.</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="workingGroupsLeading" value="Yes"
                                onchange="toggleWorkingGroupsLeading()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="workingGroupsLeading" value="No"
                                onchange="toggleWorkingGroupsLeading()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="workingGroupsLeadingList" class="conditional" style="display: none;">
                        <textarea name="workingGroupsLeadingListText" rows="3"
                            placeholder="State which ones..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>25. Is your organization involved in any species or ecosystem task force? If yes, please
                        list.</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="taskForceInvolved" value="Yes" onchange="toggleTaskForce()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="taskForceInvolved" value="No" onchange="toggleTaskForce()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="taskForceList" class="conditional" style="display: none;">
                        <textarea name="taskForceListText" rows="3" placeholder="Please list..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Section 10: Significance & Interest -->
            <div class="section" data-section="10">
                <h2>Significance & Interest</h2>

                <div class="form-group">
                    <strong>Communities</strong>
                </div>

                <div class="form-group">
                    <label>26. Which species do you consider of cultural significance in Belize?</label>
                    <textarea name="culturalSpecies" rows="3" placeholder="List species..."></textarea>
                </div>

                <div class="form-group">
                    <label>27. Which species do you consider of economic significance in Belize?</label>
                    <textarea name="economicSpecies" rows="3" placeholder="List species..."></textarea>
                </div>

                <div class="form-group">
                    <label>28. Have communities that you work with expressed concern for specific species (e.g., because
                        of dwindling numbers, or persistence as a pest)?</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="communityConcern" value="Yes" onchange="toggleCommunityConcern()">
                            <span>Yes</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="communityConcern" value="No" onchange="toggleCommunityConcern()">
                            <span>No</span>
                        </label>
                    </div>
                    <div id="communityConcernDetails" class="conditional" style="display: none;">
                        <div style="overflow-x: auto;">
                            <table id="communityConcernTable">
                                <thead>
                                    <tr>
                                        <th>Community</th>
                                        <th>District</th>
                                        <th>Species</th>
                                        <th>Reason of Concern</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="communityConcernBody">
                                    <tr>
                                        <td><input type="text" name="ccCommunity_0"></td>
                                        <td><input type="text" name="ccDistrict_0"></td>
                                        <td><input type="text" name="ccSpecies_0"></td>
                                        <td><input type="text" name="ccReason_0"></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <button type="button" class="add-row-btn" onclick="addCommunityConcernRow()">Add Row</button>
                    </div>
                </div>

                <div class="form-group">
                    <strong>Managers &amp; Experts</strong>
                </div>

                <div class="form-group">
                    <label>29. If any, which potential species/taxa would your organization be interested in monitoring
                        or
                        studying in the future? Why?</label>
                    <textarea name="futureMonitoring" rows="4"
                        placeholder="List species/taxa and reasons..."></textarea>
                </div>

                <div class="form-group">
                    <label>30. Which species/taxa in Belize do you think need more biodiversity monitoring, because
                        of:</label>
                    <div class="conditional">
                        <label>A. Lack of or gap in monitoring:</label>
                        <textarea name="speciesMonitoringGap" rows="2" placeholder="Your response..."></textarea>
                    </div>
                    <div class="conditional">
                        <label>B. Importance of the species/taxa (please explain):</label>
                        <textarea name="speciesMonitoringImportance" rows="2" placeholder="Your response..."></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label>31. Which area(s) in Belize do you think need more biodiversity monitoring, because
                        of:</label>
                    <div class="conditional">
                        <label>Lack of or gap in monitoring:</label>
                        <textarea name="areaMonitoringGap" rows="2" placeholder="Your response..."></textarea>
                    </div>
                    <div class="conditional">
                        <label>Importance of the area (please explain):</label>
                        <textarea name="areaMonitoringImportance" rows="2" placeholder="Your response..."></textarea>
                    </div>
                </div>
            </div>

            <script>
                /* -----------------------------
                   Section navigation & progress
                ------------------------------ */
                let currentSection = 0;
                const sections = document.querySelectorAll(".section");
                const totalSections = sections.length;

                document.getElementById("totalSections").textContent = totalSections;

                function showSection(index) {
                    sections.forEach((s, i) => {
                        s.classList.toggle("active", i === index);
                    });

                    document.getElementById("currentSection").textContent = index + 1;
                    document.getElementById("sectionName").textContent =
                        sections[index].querySelector("h2")?.textContent || "Introduction";

                    const progress = ((index + 1) / sections.length) * 100;
                    document.getElementById("progressFill").style.width = `${progress}%`;

                    document.getElementById("prevBtn").disabled = index === 0;
                    document.getElementById("nextBtn").textContent =
                        index === sections.length - 1 ? "Finish" : "Next";
                }

                function shouldSkipMonitoringSections() {
                    const noRadio = document.querySelector('input[name="doesMonitoring"][value="No"]');
                    return noRadio && noRadio.checked;
                }

                function nextSection() {
                    document.querySelectorAll(".validation-error").forEach(el => el.style.display = "none");

                    if (currentSection === 1 && !document.querySelector('input[name="organizationName"]').value.trim()) {
                        document.getElementById("validateOrgName").style.display = "block";
                        return;
                    }
                    if (currentSection === 2 && !document.querySelector('input[name="doesMonitoring"]:checked')) {
                        document.getElementById("validateMonitoring").style.display = "block";
                        return;
                    }

                    let next = currentSection + 1;
                    if (shouldSkipMonitoringSections() && next >= 3 && next <= 8) {
                        next = 9;
                    }
                    if (next < sections.length) {
                        currentSection = next;
                        showSection(currentSection);
                        saveProgress();
                    } else {
                        saveProgress();
                        document.getElementById("surveyForm").requestSubmit();
                    }
                }

                function prevSection() {
                    let prev = currentSection - 1;
                    if (shouldSkipMonitoringSections() && prev >= 3 && prev <= 8) {
                        prev = 2;
                    }
                    if (prev >= 0) {
                        currentSection = prev;
                        showSection(currentSection);
                        saveProgress();
                    }
                }

                /* -----------------------------
                   Conditional logic
                ------------------------------ */
                function toggleMonitoringQuestions() {
                    const yes = document.querySelector('input[name="doesMonitoring"][value="Yes"]').checked;
                    document.getElementById("monitoringAreasSection").style.display = yes ? "block" : "none";
                }

                function toggleCollaboration() {
                    const yes = document.querySelector('input[name="collaboration"][value="Yes"]').checked;
                    document.getElementById("collaborationOrgs").style.display = yes ? "block" : "none";
                }

                function toggleShareData() {
                    const yes = document.querySelector('input[name="shareData"][value="Yes"]').checked;
                    document.getElementById("shareDataWho").style.display = yes ? "block" : "none";
                }

                function toggleOnlineRepos() {
                    const yes = document.querySelector('input[name="onlineRepos"][value="Yes"]').checked;
                    document.getElementById("onlineReposWhich").style.display = yes ? "block" : "none";
                }


                function togglePublishPapers() {
                    const yes = document.querySelector('input[name="publishPapers"][value="Yes"]').checked;
                    const container = document.getElementById("publishPapersFrequency");
                    if (!container) return;
                    container.style.display = yes ? "block" : "none";

                    if (!yes) {
                        container.querySelectorAll('input[type="radio"]').forEach(radio => {
                            radio.checked = false;
                        });
                    }
                }

                function toggleDigitizationPortals() {
                    const dataPortals = document.querySelector('input[type="checkbox"][name="digitization"][value="Data portals"]').checked;
                    document.getElementById("digitizationPortalsList").style.display = dataPortals ? "block" : "none";
                }

                function toggleWorkingGroups() {
                    const yes = document.querySelector('input[name="workingGroupsInvolved"][value="Yes"]').checked;
                    document.getElementById("workingGroupsList").style.display = yes ? "block" : "none";
                }

                function toggleWorkingGroupsLeading() {
                    const yes = document.querySelector('input[name="workingGroupsLeading"][value="Yes"]').checked;
                    document.getElementById("workingGroupsLeadingList").style.display = yes ? "block" : "none";
                }

                function toggleTaskForce() {
                    const yes = document.querySelector('input[name="taskForceInvolved"][value="Yes"]').checked;
                    document.getElementById("taskForceList").style.display = yes ? "block" : "none";
                }

                function toggleCommunityConcern() {
                    const yes = document.querySelector('input[name="communityConcern"][value="Yes"]').checked;
                    document.getElementById("communityConcernDetails").style.display = yes ? "block" : "none";
                }

                function toggleMammalsOptions() {
                    const mammals = document.querySelector('input[name="monitoringAreas"][value="Mammals"]').checked;
                    const container = document.getElementById("mammalsOptions");
                    if (!container) return;
                    container.hidden = !mammals;

                    if (!mammals) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                    }
                }

                function toggleFishOptions() {
                    const fish = document.querySelector('input[name="monitoringAreas"][value="Fish"]').checked;
                    const container = document.getElementById("fishOptions");
                    if (!container) return;
                    container.hidden = !fish;

                    if (!fish) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                        const marineContainer = document.getElementById("marineFishOptions");
                        if (marineContainer) marineContainer.hidden = true;
                    }
                }

                function toggleMarineFishOptions() {
                    const marine = document.querySelector('input[name="monitoringAreas"][value="Fish - Marine fish"]').checked;
                    const container = document.getElementById("marineFishOptions");
                    if (!container) return;
                    container.hidden = !marine;

                    if (!marine) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleMarineInvertebratesOptions() {
                    const checked = document.querySelector('input[name="monitoringAreas"][value="Marine Invertebrates"]').checked;
                    const container = document.getElementById("marineInvertebratesOptions");
                    if (!container) return;
                    container.hidden = !checked;

                    if (!checked) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleFreshwaterMacroOptions() {
                    const checked = document.querySelector('input[name="monitoringAreas"][value="Freshwater Macroinvertebrate"]').checked;
                    const container = document.getElementById("freshwaterMacroOptions");
                    if (!container) return;
                    container.hidden = !checked;

                    if (!checked) {
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleTerrestrialInvertebratesOptions() {
                    const checked = document.querySelector('input[name="monitoringAreas"][value="Terrestrial Macroinvertebrates"]').checked;
                    const container = document.getElementById("terrestrialInvertebratesOptions");
                    if (!container) return;
                    container.hidden = !checked;

                    if (!checked) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleAmphibiansOptions() {
                    const checked = document.querySelector('input[name="monitoringAreas"][value="Amphibians"]').checked;
                    const container = document.getElementById("amphibiansOptions");
                    if (!container) return;
                    container.hidden = !checked;

                    if (!checked) {
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleReptilesOptions() {
                    const rep = document.querySelector('input[name="monitoringAreas"][value="Reptiles"]').checked;
                    const container = document.getElementById("reptilesOptions");
                    if (!container) return;
                    container.hidden = !rep;

                    if (!rep) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function togglePlantsOptions() {
                    const plants = document.querySelector('input[name="monitoringAreas"][value="Plants"]').checked;
                    const container = document.getElementById("plantsOptions");
                    if (!container) return;
                    container.hidden = !plants;

                    if (!plants) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleSurveyEquipmentSpecify() {
                    const checked = document.querySelector('input[name="techGaps"][value="Lack of survey equipment"]').checked;
                    const container = document.getElementById("surveyEquipmentSpecify");
                    if (!container) return;
                    container.hidden = !checked;

                    if (!checked) {
                        container.querySelectorAll('input[type="text"]').forEach(t => {
                            t.value = '';
                        });
                    }
                }

                function toggleSoftwareTrainingOptions() {
                    const checked = document.querySelector('input[name="trainingNeeds"][value="Software"]').checked;
                    const container = document.getElementById("softwareTrainingOptions");
                    if (!container) return;
                    container.hidden = !checked;

                    if (!checked) {
                        container.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                            cb.checked = false;
                        });
                    }
                }

                /* -----------------------------
                   Dynamic table rows
                ------------------------------ */
                let ltRow = 1;
                function addLongTermRow() {
                    const row = document.createElement("tr");
                    row.innerHTML = `
        <td><input type="text" name="ltSpecies_${ltRow}"></td>
        <td><input type="text" name="ltSites_${ltRow}"></td>
        <td><input type="text" name="ltYears_${ltRow}"></td>
        <td><input type="text" name="ltMethods_${ltRow}"></td>
        <td><input type="text" name="ltOngoing_${ltRow}"></td>
        <td><span class="remove-btn" onclick="this.closest('tr').remove(); scheduleAutoSave()">Remove</span></td>
    `;
                    document.getElementById("longTermBody").appendChild(row);
                    ltRow++;
                    scheduleAutoSave();
                }

                let ccRow = 1;
                function addCommunityConcernRow() {
                    const row = document.createElement("tr");
                    row.innerHTML = `
        <td><input type="text" name="ccCommunity_${ccRow}"></td>
        <td><input type="text" name="ccDistrict_${ccRow}"></td>
        <td><input type="text" name="ccSpecies_${ccRow}"></td>
        <td><input type="text" name="ccReason_${ccRow}"></td>
        <td><span class="remove-btn" onclick="this.closest('tr').remove(); scheduleAutoSave()">Remove</span></td>
    `;
                    document.getElementById("communityConcernBody").appendChild(row);
                    ccRow++;
                    scheduleAutoSave();
                }

                let rrRow = 1;
                function addRecentResearchRow() {
                    const row = document.createElement("tr");
                    row.innerHTML = `
        <td><input type="text" name="rrSpecies_${rrRow}"></td>
        <td><input type="text" name="rrSites_${rrRow}"></td>
        <td><input type="text" name="rrYears_${rrRow}"></td>
        <td><input type="text" name="rrMethods_${rrRow}"></td>
        <td><span class="remove-btn" onclick="this.closest('tr').remove(); scheduleAutoSave()">Remove</span></td>
    `;
                    document.getElementById("recentResearchBody").appendChild(row);
                    rrRow++;
                    scheduleAutoSave();
                }

                /* -----------------------------
                   localStorage persistence
                ------------------------------ */
                const STORAGE_KEY = 'nbmp_survey_progress';
                let saveTimeout;

                function scheduleAutoSave() {
                    clearTimeout(saveTimeout);
                    saveTimeout = setTimeout(saveProgress, 300);
                }

                function saveProgress() {
                    const form = document.getElementById('surveyForm');
                    const state = { currentSection, ltRow, rrRow, ccRow, fields: {} };

                    form.querySelectorAll('input[type="text"], textarea').forEach(el => {
                        if (el.name) state.fields[el.name] = el.value;
                    });

                    const radioNames = new Set();
                    form.querySelectorAll('input[type="radio"]').forEach(el => radioNames.add(el.name));
                    radioNames.forEach(name => {
                        const checked = form.querySelector(`input[type="radio"][name="${name}"]:checked`);
                        if (checked) state.fields[name] = checked.value;
                    });

                    const cbNames = new Set();
                    form.querySelectorAll('input[type="checkbox"]').forEach(el => cbNames.add(el.name));
                    cbNames.forEach(name => {
                        const vals = [...form.querySelectorAll(`input[type="checkbox"][name="${name}"]:checked`)]
                            .map(el => el.value);
                        if (vals.length) state.fields[name] = vals;
                    });

                    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
                }

                function restoreProgress() {
                    let saved;
                    try {
                        saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
                    } catch (e) {
                        localStorage.removeItem(STORAGE_KEY);
                        return;
                    }
                    if (!saved || !saved.fields) return;

                    // Recreate dynamic table rows before populating values
                    while (ltRow < saved.ltRow) addLongTermRow();
                    while (rrRow < saved.rrRow) addRecentResearchRow();
                    while (ccRow < saved.ccRow) addCommunityConcernRow();

                    const form = document.getElementById('surveyForm');
                    Object.entries(saved.fields).forEach(([name, value]) => {
                        if (Array.isArray(value)) {
                            value.forEach(v => {
                                const cb = form.querySelector(`input[type="checkbox"][name="${name}"][value="${v}"]`);
                                if (cb) cb.checked = true;
                            });
                        } else {
                            const radio = form.querySelector(`input[type="radio"][name="${name}"][value="${value}"]`);
                            if (radio) {
                                radio.checked = true;
                            } else {
                                const el = form.querySelector(`[name="${name}"]`);
                                if (el) el.value = value;
                            }
                        }
                    });

                    // Re-fire all conditional toggles so visibility matches restored state
                    toggleMonitoringQuestions();
                    toggleMammalsOptions();
                    toggleFishOptions();
                    toggleMarineFishOptions();
                    toggleMarineInvertebratesOptions();
                    toggleFreshwaterMacroOptions();
                    toggleTerrestrialInvertebratesOptions();
                    toggleAmphibiansOptions();
                    toggleReptilesOptions();
                    togglePlantsOptions();
                    toggleSurveyEquipmentSpecify();
                    toggleSoftwareTrainingOptions();
                    toggleCollaboration();
                    toggleDigitizationPortals();
                    toggleShareData();
                    toggleOnlineRepos();
                    togglePublishPapers();
                    toggleWorkingGroups();
                    toggleWorkingGroupsLeading();
                    toggleTaskForce();
                    toggleCommunityConcern();

                    if (typeof saved.currentSection === 'number') {
                        currentSection = saved.currentSection;
                        showSection(currentSection);
                    }
                }

                /* -----------------------------
                   Init
                ------------------------------ */
                showSection(currentSection);
                restoreProgress();

                document.getElementById('surveyForm').addEventListener('input', scheduleAutoSave);
                document.getElementById('surveyForm').addEventListener('change', scheduleAutoSave);


                /* -----------------------------
Submit  Thank you page
------------------------------ */
                document.getElementById("surveyForm").addEventListener("submit", async function (e) {
                    e.preventDefault();
                    document.getElementById("errorMsg").style.display = "none";

                    const nextBtn = document.getElementById("nextBtn");
                    const prevBtn = document.getElementById("prevBtn");
                    const originalNextText = nextBtn.textContent;
                    nextBtn.disabled = true;
                    prevBtn.disabled = true;
                    nextBtn.textContent = "Submitting...";

                    const success = await submitToGoogleSheet();

                    if (!success) {
                        document.getElementById("errorMsg").style.display = "block";
                        nextBtn.disabled = false;
                        prevBtn.disabled = false;
                        nextBtn.textContent = originalNextText;
                        return;
                    }

                    localStorage.removeItem(STORAGE_KEY);

                    document.querySelector("h1").style.display = "none";
                    document.querySelector(".header-info").style.display = "none";
                    document.querySelector(".progress-bar").style.display = "none";
                    document.querySelector(".navigation").style.display = "none";
                    document.getElementById("surveyForm").style.display = "none";
                    document.getElementById("thankYou").style.display = "block";
                });

                async function submitToGoogleSheet() {
                    const form = document.getElementById("surveyForm");
                    const formData = new FormData(form);

                    // IMPORTANT: handle multi-value fields (checkboxes)
                    const data = {};
                    for (let [key, value] of formData.entries()) {
                        if (data[key]) {
                            data[key] += "; " + value;   // combine checkbox values
                        } else {
                            data[key] = value;
                        }
                    }

                    try {
                        const response = await fetch(
                            "https://script.google.com/macros/s/AKfycbwO0CAGANxGtoIWInOaIn6HiEZUIUnqMUuZRIOTzcQbBoVfsSg86weZNjCWD_bE6_-Nxg/exec",
                            {
                                method: "POST",
                                headers: { "Content-Type": "application/json" },
                                body: JSON.stringify(data)
                            }
                        );

                        return response.ok;
                    } catch (err) {
                        console.error("Submit failed:", err);

                        // Retry with no-cors (common workaround for Apps Script CORS from file://)
                        try {
                            await fetch(
                                "https://script.google.com/macros/s/AKfycbx62RysZB3Bt8T7-XEPL1BM0mJqH68gLneAtXMJoV3UBNRXuDnHqVCfrsn6VYhItYv-2g/exec",
                                {
                                    method: "POST",
                                    mode: "no-cors",
                                    headers: { "Content-Type": "application/json" },
                                    body: JSON.stringify(data)
                                }
                            );
                            return true; // can't read response in no-cors, assume sent
                        } catch (retryErr) {
                            console.error("Submit retry failed:", retryErr);
                            return false;
                        }
                    }
                }



            </script>
        </form>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 10%"></div>
        </div>

        <div class="navigation">
            <button type="button" class="nav-btn prev" id="prevBtn" onclick="prevSection()">Previous</button>
            <button type="button" class="nav-btn next" id="nextBtn" onclick="nextSection()">Next</button>
        </div>
        <div class="error-msg" id="errorMsg">There was an error saving your response. <button type="button"
                class="retry-btn" onclick="document.getElementById('surveyForm').requestSubmit()">Retry</button></div>

        <div class="thank-you-box" id="thankYou">
            <h2>Thank you!</h2>
            <p>Your response has been successfully recorded.</p>
            <p>We sincerely appreciate your time and contribution to the<br>
                National Biodiversity Monitoring Plan for Belize.</p>
        </div>
    </div>
</body>

</html>